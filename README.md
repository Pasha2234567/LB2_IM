# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2: –î–∞—Ç—á–∏–∫–∏ –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª

## –°—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–¥—ã
- [custom_rng.h](custom_rng.h) ‚Äî –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª —Å –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏ —Ñ—É–Ω–∫—Ü–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤.
- [custom_rng.cpp](custom_rng.cpp) ‚Äî –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª (—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ, –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –∏ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π).
- [test_rng.cpp](test_rng.cpp) ‚Äî –ö–æ–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤, –≤–∫–ª—é—á–∞—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–º–∏.

---

## –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ì–ü–°–ß –∏ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
–ê–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª (–ì–ü–°–ß) –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ [0, 1) –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –º–µ—Ç–æ–¥–µ —É–º–Ω–æ–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º 32-–±–∏—Ç–Ω–æ–π signed –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è.  
–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π b –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ time(NULL) –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ.  
–ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è y = b * 1220703125; –µ—Å–ª–∏ y < 0, –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è 2 * 1073741824 –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏. –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è —É–º–Ω–æ–∂–µ–Ω–∏–µ–º –Ω–∞ 4.656613e-10f, –ø–æ—Å–ª–µ —á–µ–≥–æ b –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º y.

–î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è N(mean, stddev¬≤) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø—Ä–µ–¥–µ–ª—å–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞: –±–µ—Ä—ë—Ç—Å—è —Å—É–º–º–∞ 12 —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã—Ö —á–∏—Å–µ–ª, —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ø–æ œÉ.  
–î–ª—è —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º Œª –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ –æ–±—Ä–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏: x = -log(r) / Œª.

–§—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã float*, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è —Å –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º <random> (Mersenne Twister).

---

## –ú–µ—Ç–æ–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1Ô∏è‚É£ –¢–µ—Å—Ç –Ω–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å (–≤–∏–∑—É–∞–ª—å–Ω—ã–π ‚Äî –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞)
–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —á–∞—Å—Ç–æ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ 10 –±–∏–Ω–Ω–∞–º. –î–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±–ª–∏–∑–∫–∏ –∫ N/10 (–¥–ª—è N=10000 ‚Äî –æ–∫–æ–ª–æ 1000).  
–î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –∏ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã ‚Äî —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∫–æ–ª–æ–∫–æ–ª –∏ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Å–ø–∞–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

### 2Ô∏è‚É£ –¢–µ—Å—Ç –Ω–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å (—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π ‚Äî œá¬≤)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≥–∏–ø–æ—Ç–µ–∑–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.  
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:  
\[
œá¬≤ = Œ£((observed - expected)¬≤ / expected)
\]
–ï—Å–ª–∏ p > 0.05, –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –æ—Ç–≤–µ—Ä–≥–∞–µ—Ç—Å—è (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ).

### 3Ô∏è‚É£ –¢–µ—Å—Ç –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (–∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏:
\[
corr = cov(x_i, x_{i+1}) / var(x)
\]
–î–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π |corr| < 0.05.

### 4Ô∏è‚É£ –ü–æ–∏—Å–∫ –ø–µ—Ä–∏–æ–¥–∞
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ 100000 —á–∏—Å–µ–ª.  
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è unordered_map –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π. –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ—Ç ‚Äî –ø–µ—Ä–∏–æ–¥ –¥–ª–∏–Ω–Ω–µ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è 10000 —á–∏—Å–µ–ª –¥–ª—è –≤—Å–µ—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ 100000 ‚Äî –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–∏–æ–¥–∞.

---

### ‚öôÔ∏è –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –Ω–∞—à–µ–≥–æ –ì–ü–°–ß
| –ë–∏–Ω | –ò–Ω—Ç–µ—Ä–≤–∞–ª | –ß–∞—Å—Ç–æ—Ç–∞ |
|----:|:----------|--------:|
| 0 | 0‚Äì0.1 | 988 |
| 1 | 0.1‚Äì0.2 | 1005 |
| 2 | 0.2‚Äì0.3 | 1022 |
| 3 | 0.3‚Äì0.4 | 1018 |
| 4 | 0.4‚Äì0.5 | 994 |
| 5 | 0.5‚Äì0.6 | 996 |
| 6 | 0.6‚Äì0.7 | 997 |
| 7 | 0.7‚Äì0.8 | 944 |
| 8 | 0.8‚Äì0.9 | 1036 |
| 9 | 0.9‚Äì1.0 | 1000 |

œá¬≤ = 5.47  
–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (–ª–∞–≥ 1) = -0.0121237  
–ü–µ—Ä–∏–æ–¥: –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ 100000 —á–∏—Å–ª–∞—Ö.

---

### ‚öôÔ∏è –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ—á–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
| –ë–∏–Ω | –ò–Ω—Ç–µ—Ä–≤–∞–ª | –ß–∞—Å—Ç–æ—Ç–∞ |
|----:|:----------|--------:|
| 0 | 0‚Äì0.1 | 980 |
| 1 | 0.1‚Äì0.2 | 1005 |
| 2 | 0.2‚Äì0.3 | 1012 |
| 3 | 0.3‚Äì0.4 | 982 |
| 4 | 0.4‚Äì0.5 | 1030 |
| 5 | 0.5‚Äì0.6 | 973 |
| 6 | 0.6‚Äì0.7 | 1028 |
| 7 | 0.7‚Äì0.8 | 982 |
| 8 | 0.8‚Äì0.9 | 993 |
| 9 | 0.9‚Äì1.0 | 1015 |

œá¬≤ = 3.904  
–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (–ª–∞–≥ 1) = 0.0020516

---

### ‚öôÔ∏è –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ N(0,1)
| –ë–∏–Ω | –ò–Ω—Ç–µ—Ä–≤–∞–ª | –ß–∞—Å—Ç–æ—Ç–∞ |
|----:|:----------|--------:|
| 0 | -3 ‚Äì -2.4 | 82 |
| 1 | -2.4 ‚Äì -1.8 | 272 |
| 2 | -1.8 ‚Äì -1.2 | 807 |
| 3 | -1.2 ‚Äì -0.6 | 1558 |
| 4 | -0.6 ‚Äì 0 | 2146 |
| 5 | 0 ‚Äì 0.6 | 2302 |
| 6 | 0.6 ‚Äì 1.2 | 1667 |
| 7 | 1.2 ‚Äì 1.8 | 820 |
| 8 | 1.8 ‚Äì 2.4 | 266 |
| 9 | 2.4 ‚Äì 3 | 62 |

–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (–ª–∞–≥ 1) = 0.00155259

---

### ‚öôÔ∏è –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (Œª = 1)
| –ë–∏–Ω | –ò–Ω—Ç–µ—Ä–≤–∞–ª | –ß–∞—Å—Ç–æ—Ç–∞ |
|----:|:----------|--------:|
| 0 | 0 ‚Äì 0.5 | 3955 |
| 1 | 0.5 ‚Äì 1.0 | 2443 |
| 2 | 1.0 ‚Äì 1.5 | 1400 |
| 3 | 1.5 ‚Äì 2.0 | 817 |
| 4 | 2.0 ‚Äì 2.5 | 555 |
| 5 | 2.5 ‚Äì 3.0 | 335 |
| 6 | 3.0 ‚Äì 3.5 | 201 |
| 7 | 3.5 ‚Äì 4.0 | 108 |
| 8 | 4.0 ‚Äì 4.5 | 55 |
| 9 | 4.5 ‚Äì 5.0 | 51 |

–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è (–ª–∞–≥ 1) = 0.011607

---

## üìä –í—ã–≤–æ–¥—ã
- –ù–∞—à –ì–ü–°–ß –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π.  
- œá¬≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (16.92 –ø—Ä–∏ p=0.05), —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è.  
- –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–∞–ª–∞ –ø–æ –º–æ–¥—É–ª—é ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã.  
- –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–º–µ–µ—Ç —Ñ–æ—Ä–º—É –∫–æ–ª–æ–∫–æ–ª–∞, —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ ‚Äî —É–±—ã–≤–∞—é—â—É—é –∫—Ä–∏–≤—É—é.  
- –ü–µ—Ä–∏–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ 100000 —á–∏—Å–ª–∞—Ö ‚Äî –∑–Ω–∞—á–∏—Ç, –æ–Ω –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–ª–∏–Ω—É —Ç–µ—Å—Ç–æ–≤–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---
